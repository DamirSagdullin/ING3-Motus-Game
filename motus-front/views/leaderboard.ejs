<!DOCTYPE html>
<html>
  <head>
    <title>Leaderboard</title>
    <%- include('common/imports') %>
  </head>
  <body>
    <%- include('common/navbar') %>

    <div class="container py-4">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card shadow">
            <div class="card-body">
              <h1 class="card-title mb-4 text-center"><i class="fas fa-chart-bar"></i> Leaderboard</h1>
              <ul class="nav nav-tabs d-flex">
                <li class="nav-item flex-grow-1 text-center">
                  <a class="nav-link active" id="total-tab" data-bs-toggle="tab" href="#total">Total</a>
                </li>
                <li class="nav-item flex-grow-1 text-center">
                  <a class="nav-link" id="average-tab" data-bs-toggle="tab" href="#average">Average</a>
                </li>
              </ul>
              <div class="tab-content">
                <div class="tab-pane fade show active" id="total">
                  <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Nickname</th>
                        <th scope="col">Nb Word(s) found</th>
                        <th scope="col">Average tries</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% if (leaderboardByTotal.length === 0) { %>
                      <tr>
                        <td colspan="4" class="text-center">No records found</td>
                      </tr>
                      <% } else { %> <% leaderboardByTotal.forEach((userStat, index) => { %> <% if (typeof userData !== 'undefined') { %>
                      <tr class="<%= userStat.user_id == userData.sub ? 'table-success' : '' %>">
                        <% } else { %>
                      </tr>

                      <tr>
                        <% } %>
                        <td><%= index + 1 %></td>
                        <td><%= userStat.nickname %></td>
                        <td><%= userStat.totalGuessedWords %></td>
                        <td><%= userStat.averageTries %></td>
                      </tr>
                      <% }); %> <% } %>
                    </tbody>
                  </table>
                </div>
                <div class="tab-pane fade" id="average">
                  <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Nickname</th>
                        <th scope="col">Nb Word(s) found</th>
                        <th scope="col">Average tries</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% if (leaderboardByAverage.length === 0) { %>
                      <tr>
                        <td colspan="4" class="text-center">No records found</td>
                      </tr>
                      <% } else { %> <% leaderboardByAverage.forEach((userStat, index) => { %> <% if (typeof userData !== 'undefined') { %>
                      <tr class="<%= userStat.user_id == userData.sub ? 'table-success' : '' %>">
                        <% } else { %>
                      </tr>

                      <tr>
                        <% } %>
                        <td><%= index + 1 %></td>
                        <td><%= userStat.nickname %></td>
                        <td><%= userStat.totalGuessedWords %></td>
                        <td><%= userStat.averageTries %></td>
                      </tr>
                      <% }); %> <% } %>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="mt-4">
                <a class="btn btn-primary" href="/"><i class="fa-solid fa-backward-step"></i> Go Back</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
